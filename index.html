<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nexus Points</title>

  <!-- 轻量 Tailwind 核心（仅保留常用类） -->
  <script>
    tailwind = {
      theme: {
        extend: {}
      }
    }
  </script>
  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>

  <!-- 本地安全字体，不加载 Google CDN -->
  <style>
    body { 
      font-family: 'Segoe UI', 'Exo 2', -apple-system, sans-serif;
      background: #0a0e17;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(0, 255, 255, 0.15) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(0, 204, 255, 0.15) 0%, transparent 20%),
        radial-gradient(circle at 50% 50%, rgba(9, 19, 41, 0.8) 0%, #0a0e17 100%);
    }

    /* 更轻量的 Pulse 光效 */
    .glow {
      text-shadow: 0 0 25px #00ffff75;
      animation: glow 2.4s infinite alternate;
    }
    @keyframes glow {
      from { text-shadow: 0 0 8px #00ffff55; }
      to { text-shadow: 0 0 22px #00ffffaa; }
    }

    /* 移除最卡的 Matrix Rain，改为静态半透明背景 */
    .matrix {
      position: fixed;
      inset: 0;
      opacity: 0.045;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40'%3E%3Ctext y='30' font-size='30' fill='%2300ffff'%3E%CE%A9%3C/text%3E%3C/svg%3E");
      background-repeat: repeat;
      background-size: 40px;
      z-index: 0;
    }

    /* scanline 降级，不再动画 */
    .scanline {
      position: absolute;
      top: 120px;
      left: 0; right: 0;
      height: 3px;
      background: linear-gradient(to bottom, transparent, #00ffff33);
      z-index: 50;
    }

    .card-glow {
      box-shadow: 
        0 0 25px rgba(0,255,255,0.3),
        inset 0 0 15px rgba(0,255,255,0.15);
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
</head>

<body class="relative min-h-screen text-cyan-100 overflow-x-hidden">

  <div class="matrix"></div>
  <div class="scanline"></div>

  <div class="relative z-10 min-h-screen flex flex-col items-center justify-center px-4 py-12">

    <!-- 标题 -->
    <div class="mb-12 text-center">
      <h1 class="text-6xl md:text-8xl font-black tracking-tight glow"
          style="font-family:'Orbitron','Exo 2',sans-serif;">
        Nexus Points
      </h1>
      <p class="mt-4 text-xl md:text-2xl text-cyan-300 opacity-80">
        Balance Scan // Nexus 积分批量余额查询
      </p>
      <div class="mt-4 flex justify-center space-x-8 text-sm">
        <span class="text-cyan-400">ONLINE</span>
        <span class="text-green-400 animate-pulse">CONNECTED</span>
        <span class="text-yellow-400">v5.0.1</span>
      </div>
    </div>

    <!-- 外框 -->
    <div class="relative w-full max-w-5xl">
      <div class="absolute -inset-1 bg-gradient-to-r from-cyan-500 via-purple-500 to-cyan-500 rounded-3xl blur-xl opacity-60"></div>

      <div class="relative bg-black/70 border border-cyan-500/50 rounded-3xl p-8 md:p-12 card-glow">

        <div class="flex justify-between items-center mb-10">
          <h2 class="text-3xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-400">
            Nexus Points Check
          </h2>
          <a href="https://x.com/intent/follow?screen_name=lim51314" target="_blank"
             class="px-6 py-3 bg-gradient-to-r from-cyan-600 to-purple-600 rounded-full text-sm font-bold hover:scale-105 transition">
            FOLLOW @lim51314
          </a>
        </div>

        <!-- 输入区 -->
        <div class="grid md:grid-cols-2 gap-8 mb-10">
          
          <!-- 左区域：手动输入 -->
          <div class="bg-black/60 border border-cyan-500/50 rounded-2xl p-6">
            <label class="text-cyan-300 text-sm tracking-wider">WALLET ADDRESSES</label>
            <textarea id="address" rows="8" placeholder="0x..."
              class="mt-3 w-full bg-transparent border-b-2 border-cyan-500/50 focus:border-cyan-300 outline-none text-cyan-100 placeholder-cyan-700 font-mono"></textarea>
            <button id="querySingle"
              class="mt-6 w-full py-4 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-xl font-bold hover:scale-105 transition">
              SCAN SINGLE / MULTI
            </button>
          </div>

          <!-- 右区域：批量上传 -->
          <div class="bg-black/60 border border-purple-500/50 rounded-2xl p-6">
            <label class="text-purple-300 text-sm tracking-wider">BULK UPLOAD (.txt)</label>
            <input id="fileInput" type="file" accept=".txt"
              class="mt-3 w-full file:mr-4 file:py-3 file:px-6 file:rounded-lg file:bg-gradient-to-r file:from-purple-600 file:to-pink-600 file:border-0 file:text-white hover:file:from-purple-500 hover:file:to-pink-500 cursor-pointer"/>
            <button id="queryBatch"
              class="mt-6 w-full py-4 bg-gradient-to-r from-purple-500 to-pink-600 rounded-xl font-bold hover:scale-105 transition">
              BULK SCAN
            </button>
          </div>
        </div>

        <!-- 结果 -->
        <div id="result" class="mt-10">
          <div class="flex items-center gap-4 mb-4">
            <h3 class="text-2xl font-bold text-cyan-300">SCAN RESULTS</h3>
            <div class="flex-1 h-px bg-gradient-to-r from-cyan-500 to-transparent"></div>
            <span id="status" class="text-sm text-cyan-400">READY</span>
          </div>
          <div id="resultContent"
               class="bg-black/50 border border-cyan-800/50 rounded-2xl p-6 min-h-80 font-mono text-sm overflow-x-auto">
            <p class="text-cyan-600 text-center">Enter addresses or upload file → Click scan</p>
          </div>
        </div>

      </div>
    </div>

    <div class="mt-16 text-center text-cyan-600 text-sm opacity-60">
      NEXUS NETWORK MULTI-CHAIN BALANCE CHECKER · POWERED BY CALDERA & BLOCKSCOUT
    </div>
  </div>

  <!-- JS（保持你的原逻辑） -->
  <script>
    const networks = {
      '392': { rpc: 'https://nexus.rpc.caldera.xyz/http', name: 'Test2' },
      '393': { rpc: 'https://nexus-new.rpc.caldera.aliyun.xyz/http', name: 'Devnet NEX' },
      '3945': { rpc: 'https://testnet.rpc.nexus.xyz', name: 'Nexus Testnet' }
    };

    const web3_392 = new Web3(networks['392'].rpc);
    const web3_393 = new Web3(networks['393'].rpc);
    const web3_3945 = new Web3(networks['3945'].rpc);

    function truncateAddress(address){ return `${address.slice(0,6)}...${address.slice(-4)}` }
    function formatBalance(b){ return Math.floor(b) }

    function showResult(msg, type='normal'){
      const box = document.getElementById('resultContent');
      const st = document.getElementById('status');
      box.innerHTML = msg;
      if(type==='info'){ st.textContent='SCANNING...'; st.className='text-yellow-400' }
      else if(type==='error'){ st.textContent='ERROR'; st.className='text-red-400' }
      else{ st.textContent='COMPLETE'; st.className='text-green-400' }
    }

    async function getBalance(web3, chain, addr){
      try{
        const bal = await web3.eth.getBalance(addr);
        return { ok:true, balance:formatBalance(web3.utils.fromWei(bal,'ether')) };
      }catch(e){
        return { ok:false, error:`[${chain}] Error` };
      }
    }

    async function queryAddresses(list){
      if(list.length===0) return showResult('No valid addresses！','error');
      showResult(`Scanning ${list.length} addresses...`,'info');

      let html = `<div class="overflow-x-auto"><table class="w-full text-center">
        <thead class="bg-cyan-900/50">
        <tr>
          <th class="p-3">Address</th>
          <th class="p-3">Test2</th>
          <th class="p-3">Devnet</th>
          <th class="p-3">Testnet</th>
        </tr>
        </thead><tbody>`;

      for(const a of list){
        const [r1,r2,r3]=await Promise.all([
          getBalance(web3_392,'Test2',a),
          getBalance(web3_393,'Devnet',a),
          getBalance(web3_3945,'Testnet',a)
        ]);

        const b1=r1.ok?r1.balance:`<span class='text-red-400 text-xs'>${r1.error}</span>`;
        const b2=r2.ok?r2.balance:`<span class='text-red-400 text-xs'>${r2.error}</span>`;
        const b3=r3.ok?r3.balance:`<span class='text-red-400 text-xs'>${r3.error}</span>`;

        html+=`<tr class="border-b border-cyan-900/40">
          <td class="p-3">${truncateAddress(a)}</td>
          <td class="p-3">${b1}</td>
          <td class="p-3">${b2}</td>
          <td class="p-3">${b3}</td>
        </tr>`;
      }

      html+=`</tbody></table></div>`;
      showResult(html,'normal');
    }

    document.getElementById('querySingle').onclick = ()=>{
      const text = document.getElementById('address').value.trim();
      const list = text.split('\n').map(x=>x.trim()).filter(x=>web3_392.utils.isAddress(x));
      queryAddresses(list);
    };

    document.getElementById('queryBatch').onclick = ()=>{
      const file = document.getElementById('fileInput').files[0];
      if(!file) return showResult('Please select a file！','error');
      const reader = new FileReader();
      reader.onload = e=>{
        const list=e.target.result.split('\n').map(x=>x.trim()).filter(x=>web3_392.utils.isAddress(x));
        queryAddresses(list);
      };
      reader.readAsText(file);
    };
  </script>

</body>
</html>
