<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nexus Wallet Bulk Balance Checker</title>
  <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-6 bg-gradient-to-br from-cyan-100 via-blue-50 to-teal-100 relative overflow-hidden font-[Poppins]">

  <!-- Soft floating lights -->
  <div class="absolute inset-0 z-0 overflow-hidden">
    <div class="w-[400px] h-[400px] bg-cyan-300/30 rounded-full blur-3xl absolute top-20 left-10 animate-pulse"></div>
    <div class="w-[500px] h-[500px] bg-teal-300/30 rounded-full blur-3xl absolute bottom-0 right-0 animate-pulse"></div>
  </div>

  <!-- Top Title -->
  <div class="relative z-20 flex justify-center mb-10">
    <div class="text-center">
      <h1 class="text-6xl sm:text-7xl font-extrabold bg-gradient-to-r from-cyan-500 to-blue-500 bg-clip-text text-transparent drop-shadow-md">
        NEXUS
      </h1>
      <p class="text-2xl sm:text-3xl font-semibold text-sky-700 mt-3 tracking-wide">
        Cool & Clear ❄️
      </p>
    </div>
  </div>

  <!-- Main Card -->
  <div class="relative z-10 bg-white/40 backdrop-blur-2xl border border-white/30 p-6 sm:p-8 rounded-3xl shadow-xl w-full max-w-4xl transition hover:shadow-2xl">

    <h1 class="text-3xl sm:text-4xl font-bold text-center mb-6 bg-gradient-to-r from-cyan-500 to-blue-600 bg-clip-text text-transparent drop-shadow-md">
      Nexus Wallet Bulk Balance Checker
    </h1>

    <!-- Follow Author -->
    <div class="mb-6 text-center">
      <a href="https://x.com/intent/follow?screen_name=lim51314" target="_blank"
        class="inline-block bg-gradient-to-r from-cyan-400 to-blue-500 text-white px-5 py-2 rounded-xl shadow-md hover:shadow-lg hover:opacity-90 transition">
        Follow Author (@lim51314)
      </a>
    </div>

    <!-- Single Address Query -->
    <div class="mb-6">
      <label for="address" class="block text-sm font-medium text-sky-800">Enter wallet addresses (one per line, 0x...)</label>
      <textarea id="address" rows="5" placeholder="Enter wallet addresses, one per line (0x...)" 
        class="mt-2 block w-full p-3 rounded-xl bg-white/40 text-sky-900 border border-white/50 placeholder-sky-400 backdrop-blur-sm focus:ring-2 focus:ring-cyan-400 outline-none"></textarea>
      <button id="querySingle" 
        class="mt-3 w-full bg-gradient-to-r from-cyan-400 to-blue-500 text-white py-3 rounded-xl shadow-md hover:shadow-lg hover:opacity-90 transition">
        Check Balance
      </button>
    </div>

    <!-- Batch Query -->
    <div class="mb-6">
      <label for="fileInput" class="block text-sm font-medium text-sky-800">Upload address list (.txt, one address per line)</label>
      <input id="fileInput" type="file" accept=".txt" 
        class="mt-2 block w-full p-3 rounded-xl bg-white/40 text-sky-900 border border-white/50 backdrop-blur-sm file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:bg-cyan-400 file:text-white hover:file:bg-cyan-500 transition">
      <button id="queryBatch" 
        class="mt-3 w-full bg-gradient-to-r from-teal-400 to-cyan-500 text-white py-3 rounded-xl shadow-md hover:shadow-lg hover:opacity-90 transition">
        Bulk Check
      </button>
    </div>

    <!-- Results -->
    <div id="result" class="mt-6">
      <h2 class="text-xl font-semibold text-center text-sky-800">Query Results</h2>
      <div id="resultContent" class="mt-3 p-4 bg-white/40 border border-white/30 rounded-xl overflow-x-auto text-center text-sky-900 min-w-[300px] backdrop-blur-sm"></div>
    </div>
  </div>

  <script>
    // Network configuration
    const networks = {
      '392': { rpc: 'https://nexus.rpc.caldera.xyz/http', name: 'Test2' },
      '393': { rpc: 'https://nexus-new.rpc.caldera.xyz/http', name: 'Devnet NEX' },
      '3945': { 
        rpc: 'https://testnet.rpc.nexus.xyz', 
        name: 'Nexus Testnet', 
        explorer: 'https://nexus.testnet.blockscout.com' 
      }
    };

    const web3_392 = new Web3(networks['392'].rpc);
    const web3_393 = new Web3(networks['393'].rpc);
    const web3_3945 = new Web3(networks['3945'].rpc);

    function truncateAddress(address) {
      return `${address.slice(0, 6)}...${address.slice(-4)}`;
    }

    function formatBalance(balance) {
      return Math.floor(balance);
    }

    function showResult(message, type) {
      const resultContent = document.getElementById('resultContent');
      resultContent.innerHTML = message;
      if (type === 'error') {
        resultContent.className = "mt-3 p-4 rounded-xl bg-red-100 text-red-700 border border-red-200";
      } else if (type === 'info') {
        resultContent.className = "mt-3 p-4 rounded-xl bg-cyan-100 text-cyan-700 border border-cyan-200";
      } else {
        resultContent.className = "mt-3 p-4 bg-white/40 border border-white/30 rounded-xl overflow-x-auto text-center text-sky-900 min-w-[300px] backdrop-blur-sm";
      }
    }

    async function queryAddresses(addresses) {
      if (addresses.length === 0) {
        showResult('Please enter or upload valid wallet addresses!', 'error');
        return;
      }

      showResult(`Checking ${addresses.length} address(es)...`, 'info');
      let resultHtml = `
        <div class="overflow-x-auto">
          <table class="w-full border-collapse text-center text-sky-900 rounded-xl overflow-hidden shadow-md">
            <thead class="bg-gradient-to-r from-cyan-300/60 to-blue-300/60">
              <tr>
                <th class="px-4 py-3 border-b border-white/30 text-sm sm:text-base font-semibold tracking-wide">Address</th>
                <th class="px-4 py-3 border-b border-white/30 text-sm sm:text-base font-semibold tracking-wide">${networks['392'].name} Balance (NEX)</th>
                <th class="px-4 py-3 border-b border-white/30 text-sm sm:text-base font-semibold tracking-wide">${networks['393'].name} Balance (NEX)</th>
                <th class="px-4 py-3 border-b border-white/30 text-sm sm:text-base font-semibold tracking-wide">${networks['3945'].name} Balance (NEX)</th>
              </tr>
            </thead>
            <tbody class="bg-white/40 divide-y divide-white/30 backdrop-blur-sm">
      `;

      try {
        for (const address of addresses) {
          const [balance_392, balance_393, balance_3945] = await Promise.all([
            web3_392.eth.getBalance(address).catch(e => '0'),
            web3_393.eth.getBalance(address).catch(e => '0'),
            web3_3945.eth.getBalance(address).catch(e => '0')
          ]);
          const balanceNEX_392 = formatBalance(web3_392.utils.fromWei(balance_392, 'ether'));
          const balanceNEX_393 = formatBalance(web3_393.utils.fromWei(balance_393, 'ether'));
          const balanceNEX_3945 = formatBalance(web3_3945.utils.fromWei(balance_3945, 'ether'));
          resultHtml += `
            <tr class="hover:bg-cyan-100/60 transition">
              <td class="px-4 py-2">${truncateAddress(address)}</td>
              <td class="px-4 py-2">${balanceNEX_392}</td>
              <td class="px-4 py-2">${balanceNEX_393}</td>
              <td class="px-4 py-2">${balanceNEX_3945}</td>
            </tr>
          `;
        }
        resultHtml += `</tbody></table></div>`;
        showResult(resultHtml, 'success');
      } catch (error) {
        showResult(`Query failed: ${error.message}`, 'error');
      }
    }

    document.getElementById('querySingle').addEventListener('click', async () => {
      const input = document.getElementById('address').value.trim();
      const addresses = input.split('\n').map(addr => addr.trim()).filter(addr => addr && web3_392.utils.isAddress(addr));
      await queryAddresses(addresses);
    });

    document.getElementById('queryBatch').addEventListener('click', async () => {
      const fileInput = document.getElementById('fileInput');
      if (!fileInput.files.length) {
        showResult('Please upload a text file with addresses!', 'error');
        return;
      }

      const file = fileInput.files[0];
      const reader = new FileReader();
      reader.onload = async (e) => {
        const addresses = e.target.result.split('\n').map(addr => addr.trim()).filter(addr => addr && web3_392.utils.isAddress(addr));
        await queryAddresses(addresses);
      };
      reader.readAsText(file);
    });
  </script>
</body>
</html>
